// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

// Note that some adapters may set a maximum length for the String type by default, please ensure your strings are long
// enough when changing adapters.
// See https://www.prisma.io/docs/orm/reference/prisma-schema-reference#string for more information
datasource db {
  provider = "sqlite"
  url      = "file:dev.sqlite"
}

model Session {
  id                              String    @id
  shop                            String
  storeName                       String?
  state                           String
  isOnline                        Boolean   @default(false)
  scope                           String?
  expires                         DateTime?
  accessToken                     String
  volumeDiscountFunctionId        String?
  storeDiscountMetaFieldId        String?

  // User Information
  userId                          String?
  firstName                       String?
  lastName                        String?
  email                           String?
  url                             String?
  shopOwnerName                   String?
  accountOwner                    Boolean   @default(false)
  locale                          String?
  collaborator                    Boolean?  @default(false)
  emailVerified                   Boolean?  @default(false)

  // Shop Information
  currency                        String?
  timezone                        String?
  planDisplayName                 String?
  activeThemeGid                  String?
  isPartnerDevelopment            Boolean?  @default(false)
  isShopifyPlus                   Boolean?  @default(false)

  // Money Formats
  moneyFormat                     String?
  moneyInEmailsFormat             String?
  moneyWithCurrencyFormat         String?
  moneyWithCurrencyInEmailsFormat String?

  // API Support
  checkoutApiSupported            Boolean?  @default(false)

  // Relations
  discountBundles                 DiscountBundle[]
}

model DiscountBundle {
  id                    Int       @id @default(autoincrement())
  name                  String
  type                  String    @default("")
  previewEnabled        Boolean   @default(false)
  whichProducts         String    @default("")
  layout                String    @default("")
  priority              Int       @default(0)
  active                Boolean   @default(false)
  shopifyDiscountId     String?
  sessionId             String
  session               Session   @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  selectedProducts      String?
  selectedCollections   String?
  excludedProducts      String?
  excludedCollections   String?
  volumeBundles         String?
  pricingTiers          String?
  discountCalculation   String?
  activeDates           String?
  specificDates         String?
  storeDisplay          String?
  designOptions         String?
  customDesigns         String?
  previewOptions        String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
}